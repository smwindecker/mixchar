<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mixture Model for the Deconvolution of Thermal Decay Curves • mixchar</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<meta property="og:title" content="Mixture Model for the Deconvolution of Thermal Decay Curves">
<meta property="og:description" content="Deconvolution of thermal decay curves allows you to quantify proportions 
    of biomass components in plant litter. Thermal decay curves derived from 
    thermogravimetric analysis (TGA) are imported, modified, and then modelled in a 
    three- or four- part  mixture model using the Fraser-Suzuki function. The output 
    is estimates for weights of pseudo-components corresponding to hemicellulose, 
    cellulose, and lignin. For more information see: Müller-Hagedorn, M. and Bockhorn, 
    H. (2007) &lt;doi:10.1016/j.jaap.2006.12.008&gt;, Órfão, J. J. M. and Figueiredo, J. L. 
    (2001) &lt;doi:10.1016/S0040-6031(01)00634-7&gt;, and Yang, H. and Yan, R. and 
    Chen, H. and Zheng, C. and Lee, D. H. and Liang, D. T. (2006) &lt;doi:10.1021/ef0580117&gt;.">
<meta property="og:image" content="http://smwindecker.github.io/mixchar/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">mixchar</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1.0000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/mixchar.html">Workflow with mixchar</a>
    </li>
    <li>
      <a href="articles/Background.html">Detailed methodology</a>
    </li>
  </ul>
</li>
<li>
  <a href="reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
<li>
  <a href="news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/smwindecker/mixchar" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="section">
<img src="reference/figures/logo.png" height="80" width="350"><a class="anchor" aria-label="anchor" href="#section"></a>
</h1></div>
<p><a href="https://cran.r-project.org/package=mixchar" class="external-link"><img src="http://www.r-pkg.org/badges/version/mixchar" alt="CRAN"></a> <a href="https://travis-ci.org/smwindecker/mixchar" class="external-link"><img src="https://travis-ci.com/smwindecker/mixchar.svg?branch=master" alt="Build Status"></a> <a href="https://codecov.io/gh/smwindecker/mixchar" class="external-link"><img src="https://codecov.io/gh/smwindecker/mixchar/branch/master/graph/badge.svg" alt="codecov"></a> <a href="http://www.repostatus.org/#active" class="external-link"><img src="http://www.repostatus.org/badges/latest/active.svg" alt="repo status"></a> <a href="https://zenodo.org/badge/latestdoi/103010631" class="external-link"><img src="https://zenodo.org/badge/103010631.svg" alt="DOI"></a></p>
<p>Please cite <a href="https://openresearchsoftware.metajnl.com/articles/10.5334/jors.249" class="external-link">Windecker et al, 2021</a></p>
</div>
<div class="section level1">
<h1 id="why-deconvolution">Why deconvolution?<a class="anchor" aria-label="anchor" href="#why-deconvolution"></a>
</h1>
<p>Plant cell wall biomass is composed of a range of different types of carbon. Proportions of primary carbon types are useful for estimating kinetic decay parameters or for calculation of intrinsic plant traits. Traditional methods for calculation of these components involve wet chemistry methods that can be monetarily and environmentally costly. Thermogravimetric analysis is an alternative method, already in use in the biofuel field, that involves pyrolysing dry, ground plant litter and estimating components from resulting mass decay peaks. Since different carbon types break down relatively independently during different temperature phases, we can separate the multi-peaked rate of mass loss curve into constituent parts using a mixture model. This package conducts this peak separation analysis in a open-source and reproducible way using R. This methodology has been tested on a range of plant litter composed primarily of soluble carbohydrates, hemicellulose, cellulose, and lignin.</p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>You can install <code>mixchar</code> by:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"mixchar"</span><span class="op">)</span></span></code></pre></div>
<p>or install the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"smwindecker/mixchar"</span><span class="op">)</span></span></code></pre></div>
<p>Below we will show a basic implementation of the package. For a detailed step by step workflow, see the <a href="http://smwindecker.github.io/mixchar/articles/mixchar.html">workflow vignette on the website</a>.</p>
<p>For a detailed discussion of the methodology, please see the <a href="http://smwindecker.github.io/mixchar/articles/Background.html">methodology vignette on the website</a>.</p>
</div>
<div class="section level1">
<h1 id="basic-use">Basic use<a class="anchor" aria-label="anchor" href="#basic-use"></a>
</h1>
<p>Data from thermogravimetric analysis is usually exported in one of two forms: as mass loss or mass remaining (mg) by temperature. An example dataset that contains mass loss data for the species <em>Juncus amabilis</em> is included in the package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/smwindecker/mixchar" class="external-link">mixchar</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">juncus</span><span class="op">)</span></span>
<span><span class="co">#&gt;   temp_C mass_loss</span></span>
<span><span class="co">#&gt; 1 31.453 -0.000931</span></span>
<span><span class="co">#&gt; 2 31.452 -0.001340</span></span>
<span><span class="co">#&gt; 3 31.450 -0.001350</span></span>
<span><span class="co">#&gt; 4 31.450 -0.001660</span></span>
<span><span class="co">#&gt; 5 31.450 -0.001680</span></span>
<span><span class="co">#&gt; 6 31.450 -0.001800</span></span></code></pre></div>
<p>We can use the function <code><a href="reference/process.html">process()</a></code> to take the derivative of this data, resulting in rate of mass loss over temperature data. To do so you need to specify the dataset, the initial mass of sample, the name of the temperature data column, and the name of your mass loss or mass data column. If you have mass loss data you can specify with <code>mass_loss</code> argument, if it’s mass remaining data you can use the <code>mass</code> argument. You only need to provide one. The function defaults to temperature data in Celsius, but you can also indicate the data is provided in Kelvin, by adding <code>temp_units = 'K'</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/process.html">process</a></span><span class="op">(</span><span class="va">juncus</span>, </span>
<span>               init_mass <span class="op">=</span> <span class="fl">18.96</span>, </span>
<span>               temp <span class="op">=</span> <span class="st">'temp_C'</span>, </span>
<span>               mass_loss <span class="op">=</span> <span class="st">'mass_loss'</span><span class="op">)</span></span></code></pre></div>
<p>The default plot function for the derivative data shows you both the mass with temperature curve and the derivative rate of mass loss curve.</p>
<p>Processed data then needs to be deconvolved into its constituent parts. The deconvolve function takes care of this step, by cropping the derivative data to exclude dehydration and then running the Fraser-Suzuki mixture model and estimating individual peak parameters and weights.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/deconvolve.html">deconvolve</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></span></code></pre></div>
<p>Although most biomass samples have only three main components (corresponding to hemicellulose, cellulose, and lignin), some have a second hemicellulose peak in the low temperature range. The function will decide whether three or four peaks are best, but you can override it by modifying the <code>n_peaks</code> argument. The function also has built in starting values for the nonlinear optimisation. If you’d like to modify those or the upper and lower bounds for the estimates, you can also do so with the <code>start_vec</code>, <code>lower_vec</code>, and <code>upper_vec</code> arguments to <code><a href="reference/deconvolve.html">deconvolve()</a></code>.</p>
<p>The <code><a href="reference/deconvolve.html">deconvolve()</a></code> function results in a variety of outputs. You can use a accessor functions to look at these. <code><a href="reference/component_weights.html">component_weights()</a></code> will display the weights of each carbon component, <code><a href="reference/rate_data.html">rate_data()</a></code> will show you the modified dataset used for fitting, <code><a href="reference/model_fit.html">model_fit()</a></code> will show you the model fit, and <code><a href="reference/temp_bounds.html">temp_bounds()</a></code> will print the temperature values at which the data were cropped for analysis. You can also plot the resulting output using the default plotting function, which can be in black and white or in colour.</p>
</div>
<div class="section level1">
<h1 id="contribution">Contribution<a class="anchor" aria-label="anchor" href="#contribution"></a>
</h1>
<p>This is still a work in progress! If you see any mistakes, or find that the code is not functioning well on your data, let us know by logging a bug on the <a href="http://www.github.com/smwindecker/mixchar/issues" class="external-link">issues page</a>.</p>
</div>
<div class="section level1">
<h1 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h1>
<p>Thank you to Nick Tierney and David Wilkinson for valuable feedback during development. Thanks to the Holsworth Wildlife Reseach Endowment &amp; The Ecological Society of Australia for support on this project.</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=mixchar" class="external-link">View on CRAN</a></li>
<li><a href="http://github.com/smwindecker/mixchar/" class="external-link">Browse source code</a></li>
<li><a href="http://github.com/smwindecker/mixchar/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing mixchar</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://github.com/smwindecker" class="external-link">Saras Windecker</a> <br><small class="roles"> Author, maintainer </small>  </li>
<li>
<a href="https://github.com/goldingn" class="external-link">Nick Golding</a> <br><small class="roles"> Author </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://github.com/smwindecker" class="external-link">Saras Windecker</a>, <a href="https://github.com/goldingn" class="external-link">Nick Golding</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
